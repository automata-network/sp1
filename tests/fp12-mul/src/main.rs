#![no_main]
sp1_zkvm::entrypoint!(main);

use core::mem::transmute;
use sp1_zkvm::syscalls::sys_fp12_bigint;

fn fp12_mul(x: &[u8; 576], y: &[u8; 576]) -> [u8; 576] {
    let mut result = [0u32; 144];
    sys_fp12_bigint(
        result.as_mut_ptr() as *mut [u32; 144],
        x.as_ptr() as *const [u32; 144],
        y.as_ptr() as *const [u32; 144],
    );
    unsafe { transmute(result) }
}

#[sp1_derive::cycle_tracker]
fn main() {
    let a: [u32; 144] = [
        2981637464, 1207552920, 2745834909, 1609109995, 1306009011, 2529106783, 3374686043,
        2164314748, 1952714411, 2946632598, 3638118781, 163303079, 2976263594, 50580376, 174202202,
        3643871402, 1541710952, 3215557132, 3406144328, 195257406, 521938342, 3694474427,
        432071105, 113444283, 2976045144, 1190775704, 4155120983, 199823516, 4274930130,
        3348216917, 1312317122, 4165752688, 3222332943, 3410608601, 1488970696, 181254369,
        2975826694, 2330971032, 3841072468, 1050742927, 2713182011, 3480876703, 3513457212,
        3841280673, 1627760249, 3126742776, 2545870287, 249064455, 2975608244, 3471166360,
        3527023953, 1901662338, 1151433892, 3613536489, 1419630006, 3516808659, 33187555,
        2842876951, 3602769878, 316874541, 2977115549, 2905263000, 110501220, 754782429,
        3337561320, 121203590, 2982135840, 3178685181, 3734294741, 1795074038, 1464123456,
        278481676, 2981637464, 1207552920, 2745834909, 1609109995, 1306009011, 2529106783,
        3374686043, 2164314748, 1952714411, 2946632598, 3638118781, 163303079, 2976263594,
        50580376, 174202202, 3643871402, 1541710952, 3215557132, 3406144328, 195257406, 521938342,
        3694474427, 432071105, 113444283, 2976045144, 1190775704, 4155120983, 199823516,
        4274930130, 3348216917, 1312317122, 4165752688, 3222332943, 3410608601, 1488970696,
        181254369, 2975826694, 2330971032, 3841072468, 1050742927, 2713182011, 3480876703,
        3513457212, 3841280673, 1627760249, 3126742776, 2545870287, 249064455, 2975608244,
        3471166360, 3527023953, 1901662338, 1151433892, 3613536489, 1419630006, 3516808659,
        33187555, 2842876951, 3602769878, 316874541, 2977115549, 2905263000, 110501220, 754782429,
        3337561320, 121203590, 2982135840, 3178685181, 3734294741, 1795074038, 1464123456,
        278481676,
    ];

    let b: [u32; 144] = [
        2981637464, 1207552920, 2745834909, 1609109995, 1306009011, 2529106783, 3374686043,
        2164314738, 1952714411, 2946632598, 3638118781, 163303079, 2976263594, 50580376, 174202202,
        3643871402, 1541710952, 3215557132, 3406144328, 195257406, 521938342, 3694474427,
        432071105, 113444283, 2976045144, 1190775704, 4155120983, 199823516, 4274930130,
        3348216917, 1312317122, 4165752688, 3222332943, 3410608601, 1488970568, 181254369,
        2975826694, 2330971032, 3841072468, 1050742927, 2713182011, 3480876703, 3513457212,
        3841280673, 1627760249, 3126742776, 2545870287, 249064455, 2975608244, 3471166360,
        3527023953, 1901662338, 1151433892, 3613536489, 1419630006, 3516808659, 33187555,
        2842876951, 3602769878, 316874541, 2977115549, 2905263000, 110501220, 754782429,
        3337561320, 121203590, 2982135840, 3178685181, 3734294741, 1795074038, 1464123456,
        278481676, 2981637464, 1207552920, 2745834909, 1609109995, 1305615795, 2529106783,
        3374686043, 2164314748, 1952714411, 2946632598, 3638118781, 163303079, 2976263594,
        50580376, 174202202, 3643871402, 1541710952, 3215557132, 3406144328, 195257406, 521938342,
        3694474427, 432071105, 113444283, 2976045144, 1190775704, 4155120983, 199823516,
        4274930130, 3348216917, 1312317122, 4165752688, 3222332943, 3410608601, 1488970696,
        181254369, 2975826694, 2330971032, 3841072468, 1050742927, 2702696251, 3480876703,
        3513457212, 3841280673, 1627760249, 3126742776, 2545870287, 249064455, 2975608244,
        3471166360, 3527023953, 1901662338, 1151433892, 3613536489, 1419630006, 3516808659,
        33187555, 2842876951, 3602769878, 316874541, 2977115549, 2905263000, 110501220, 754782429,
        3337561320, 121203590, 2982135840, 3178685181, 3734294741, 1795074038, 1464123456,
        278481676,
    ];

    let expected: [u32; 144] = [
        3013880601, 2757490373, 1817338872, 33609570, 3591090417, 696154720, 3909146288, 174639895,
        2232872991, 2261393911, 3556583388, 274055226, 953808938, 1104592023, 1348269243,
        1230517746, 3195981668, 3771116990, 2864211619, 4161008019, 2165349617, 3141469793,
        3356206931, 186486506, 1537021492, 1194301035, 152519081, 64090318, 4056139965, 885680524,
        3203602772, 3998586215, 2198403726, 3026941401, 2472173195, 268113183, 767494481,
        268722579, 2175990917, 1847380528, 1998382788, 2241373312, 1859677031, 4159901007,
        2884280806, 2456670327, 4279593942, 84653478, 2987272825, 4197386607, 2538508974,
        3365384697, 358610498, 2601741768, 1737824023, 1934213501, 1150969082, 175909711,
        3199270932, 87148624, 2161257216, 487386299, 1399873181, 1464179487, 618213904, 360660564,
        2178190504, 3318286227, 3379723537, 4267018941, 72228395, 282732980, 4186838142,
        1399950155, 2121404795, 1799708892, 882195003, 609944607, 397646616, 608679335, 1034710485,
        2262982356, 1433209674, 66694825, 2458826743, 3625318596, 2972661983, 3855020905,
        1714927988, 3625166983, 1665169939, 1456194770, 2199986286, 3050661691, 3972390288,
        136024151, 3182193983, 2163122570, 3798495703, 2108850368, 1516069146, 3719394068,
        1923974352, 1407985823, 2233064049, 2530796840, 2670890162, 33253873, 3371129515,
        1207093857, 1379319850, 4134707447, 372118547, 851842868, 2054184123, 2568639928,
        3568575327, 1862678963, 167397404, 33282736, 2792351667, 1936683348, 1278522246, 326951730,
        3475934059, 1484089467, 1551673694, 2460441159, 68874115, 2115989878, 3727648373,
        141043375, 951406762, 942149397, 2740321552, 2574030152, 1290754536, 2433192659,
        2511579605, 2382392869, 2061838828, 1116288017, 3307343009, 95905485,
    ];

    unsafe {
        let a: [u8; 576] = transmute(a);
        let b: [u8; 576] = transmute(b);
        let expected: [u8; 576] = transmute(expected);

        let a_times_b = fp12_mul(&a, &b);

        assert_eq!(a_times_b, expected);
    }
}
